

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>P3DFFT++ C Reference &mdash; P3DFFT++ 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="P3DFFT++ Fortran Reference" href="p3dfft++_fortran_reference.html" />
    <link rel="prev" title="P3DFFT++ C++ Reference" href="p3dfft++_c++_reference.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #db4c3f" >
          

          
            <a href="index.html" class="icon icon-home"> P3DFFT++
          

          
          </a>

          
            
            
              <div class="version">
                3.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="home.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_p3dfft.html">Install P3DFFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="download_p3dfft.html">Download P3DFFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="p3dfft_documentation.html">P3DFFT Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_p3dfft++.html">Install P3DFFT++</a></li>
<li class="toctree-l1"><a class="reference internal" href="download_p3dfft++.html">Download P3DFFT++</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="p3dfft++_documentation.html">P3DFFT++ Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_tutorial.html">P3DFFT++ Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_c++_reference.html">P3DFFT++ C++ reference</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">P3DFFT++ C Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup-and-grid-layout">Setup and Grid Layout</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#p3dfft-setup">p3dfft_setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#p3dfft-cleanup">p3dfft_cleanup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#p3dfft-init-grid">p3dfft_init_grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="#p3dfft-free-grid">p3dfft_free_grid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#one-dimensional-transforms">One-dimensional transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#d-transform-planning">1D transform planning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#d-transform-execution">1D transform execution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#three-dimensional-transforms">Three-dimensional Transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#p3dfft-init-3dtype">p3dfft_init_3Dtype</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">3D transform planning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">3D Transform Execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#d-spectral-derivative">3D Spectral Derivative</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_fortran_reference.html">P3DFFT++ Fortran Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_c++_examples.html">P3DFFT++ C++ examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_c_examples.html">P3DFFT++ C examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_fortran_examples.html">P3DFFT++ Fortran examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="license_of_use.html">License of use</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">P3DFFT++</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="p3dfft++_documentation.html">P3DFFT++ Documentation</a> &raquo;</li>
        
      <li>P3DFFT++ C Reference</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/p3dfft++_c_reference.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="p3dfft-c-reference">
<h1><a class="toc-backref" href="#id3">P3DFFT++ C Reference</a><a class="headerlink" href="#p3dfft-c-reference" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#p3dfft-c-reference" id="id3">P3DFFT++ C Reference</a><ul>
<li><a class="reference internal" href="#setup-and-grid-layout" id="id4">Setup and Grid Layout</a><ul>
<li><a class="reference internal" href="#p3dfft-setup" id="id5">p3dfft_setup</a></li>
<li><a class="reference internal" href="#p3dfft-cleanup" id="id6">p3dfft_cleanup</a></li>
<li><a class="reference internal" href="#p3dfft-init-grid" id="id7">p3dfft_init_grid</a></li>
<li><a class="reference internal" href="#p3dfft-free-grid" id="id8">p3dfft_free_grid</a></li>
</ul>
</li>
<li><a class="reference internal" href="#one-dimensional-transforms" id="id9">One-dimensional transforms</a><ul>
<li><a class="reference internal" href="#d-transform-planning" id="id10">1D transform planning</a></li>
<li><a class="reference internal" href="#d-transform-execution" id="id11">1D transform execution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#three-dimensional-transforms" id="id12">Three-dimensional Transforms</a><ul>
<li><a class="reference internal" href="#p3dfft-init-3dtype" id="id13">p3dfft_init_3Dtype</a></li>
<li><a class="reference internal" href="#id1" id="id14">3D transform planning</a></li>
<li><a class="reference internal" href="#id2" id="id15">3D Transform Execution</a></li>
<li><a class="reference internal" href="#d-spectral-derivative" id="id16">3D Spectral Derivative</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="setup-and-grid-layout">
<h2><a class="toc-backref" href="#id4">Setup and Grid Layout</a><a class="headerlink" href="#setup-and-grid-layout" title="Permalink to this headline">¶</a></h2>
<div class="section" id="p3dfft-setup">
<h3><a class="toc-backref" href="#id5">p3dfft_setup</a><a class="headerlink" href="#p3dfft-setup" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">p3dfft_setup</span><span class="p">()</span>
</pre></div>
</div>
<p><em>Function</em>: called once in the beginning of use to initialize P3DFFT++.</p>
</div>
<div class="section" id="p3dfft-cleanup">
<h3><a class="toc-backref" href="#id6">p3dfft_cleanup</a><a class="headerlink" href="#p3dfft-cleanup" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">p3dfft_cleanup</span><span class="p">()</span>
</pre></div>
</div>
<p><em>Function</em>: called once before exit and after the use to free up P3DFFT++ structures.</p>
</div>
<div class="section" id="p3dfft-init-grid">
<h3><a class="toc-backref" href="#id7">p3dfft_init_grid</a><a class="headerlink" href="#p3dfft-init-grid" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Grid</span> <span class="o">*</span><span class="nf">p3dfft_init_grid</span><span class="p">(</span><span class="kt">int</span> <span class="n">gdims</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="kt">int</span> <span class="n">dim_conj_sym</span><span class="p">,</span><span class="kt">int</span> <span class="n">pgrid</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="kt">int</span> <span class="n">proc_order</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="kt">int</span> <span class="n">mem_order</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">MPI_Comm</span> <span class="n">mpicomm</span><span class="p">);</span>
</pre></div>
</div>
<p><em>Function</em>: Initializes a new grid with specified parameters.</p>
<p><em>Arguments</em>:</p>
<table border="1" class="colwidths-auto docutils">
<tbody valign="top">
<tr class="row-odd"><td>gdims</td>
<td>Three global grid dimensions (logical order - X, Y, Z)</td>
</tr>
<tr class="row-even"><td>dim_conj_sym</td>
<td>Dimension of the array in which a little less than half of the elements are omitted due to conjugate symmetry. This argument should be non-negative only for complex-valued arrays resulting from real-to-complex FFT in the given dimension.</td>
</tr>
<tr class="row-odd"><td>pgrid</td>
<td>Up to three dimensions of processor grid, decomposing the global grid array. Value =1 means the grid is not decomposed but is local in that logical dimension.</td>
</tr>
<tr class="row-even"><td>proc_order</td>
<td>A permutation of the 3 integers: 0, 1 and 2. Specifies the topology of processor grid on the interconnect. The dimension with lower value means the MPI tasks in that dimension are closer in ranks, e.g. value=0 means the ranks are adjacent (stride=1), value=1 means they are speard out with the stride equal to the pgrid value of the dimension with stride=1 etc</td>
</tr>
<tr class="row-odd"><td>mem_order</td>
<td>A permutation of the 3 integers: 0, 1 and 2. Specifies mapping of the logical dimension and memory storage dimensions for local memory for each MPI task. mem_order[i0] = 0 means that the i0's logical dimension is stored with stride=1 in memory. Similarly, mem_order[i1] =1 means that i1's logical dimension is stored with stride=ldims[i0] etc</td>
</tr>
<tr class="row-even"><td>mpicomm</td>
<td>The MPI communicator in which this grid lives</td>
</tr>
</tbody>
</table>
<p><em>Return value</em>: a pointer to the newly initialized Grid structure that can later be used for grid operations and to get information about the grid.</p>
<p>The Grid structure is defined as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">Grid_struct</span> <span class="p">{</span>
<span class="kt">int</span> <span class="n">taskid</span><span class="p">,</span><span class="n">numtasks</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">nd</span><span class="p">;</span> <span class="c1">//number of dimensions the volume is split over</span>
<span class="kt">int</span> <span class="n">gdims</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">//Global dimensions</span>

<span class="kt">int</span> <span class="n">dim_conj_sym</span><span class="p">;</span> <span class="c1">// Dimension of conjugate symmetry where we store N/2+1 of the data after Real-to-complex transform due to conjugate symmety;(-1 for none)</span>

<span class="kt">int</span> <span class="n">mem_order</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">//Memory ordering inside the data volume</span>
<span class="kt">int</span> <span class="n">ldims</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">//Local dimensions on THIS processor</span>
<span class="kt">int</span> <span class="n">pgrid</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">//Processor grid</span>
<span class="kt">int</span> <span class="n">proc_order</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">//Ordering of tasks in processor grid, e.g. (1,2,3) : first dimension - adjacent tasks,then second, then third dimension</span>
<span class="kt">int</span> <span class="n">P</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">//Processor grid size (in inverse order of split dimensions, i.e. rows first, then columns etc</span>
<span class="kt">int</span> <span class="n">D</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">//Ranks of Dimensions of physical grid split over rows and columns correspondingly</span>
<span class="kt">int</span> <span class="n">L</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">//Rank of Local dimension (p=1)</span>
<span class="kt">int</span> <span class="n">grid_id</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">//Position of this pencil/cube in the processor grid</span>
<span class="kt">int</span> <span class="n">grid_id_cart</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">glob_start</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">// Starting coords of this cube in the global grid</span>
<span class="n">MPI_Comm</span> <span class="n">mpi_comm_glob</span><span class="p">;</span> <span class="c1">// Global MPi communicator we are starting from</span>
<span class="n">MPI_Comm</span> <span class="n">mpi_comm_cart</span><span class="p">;</span>
<span class="n">MPI_Comm</span> <span class="n">mpicomm</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">//MPI communicators for each dimension</span>
<span class="p">}</span> <span class="p">;</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">Grid_struct</span> <span class="n">Grid</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="p3dfft-free-grid">
<h3><a class="toc-backref" href="#id8">p3dfft_free_grid</a><a class="headerlink" href="#p3dfft-free-grid" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">p3dfft_free_grid</span><span class="p">(</span><span class="n">Grid</span> <span class="o">*</span><span class="n">gr</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Function</em>: frees up grid.</p>
<p><em>Arguments</em>:</p>
<table border="1" class="colwidths-auto docutils">
<tbody valign="top">
<tr class="row-odd"><td>gr</td>
<td>pointer to Grid structure.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="one-dimensional-transforms">
<h2><a class="toc-backref" href="#id9">One-dimensional transforms</a><a class="headerlink" href="#one-dimensional-transforms" title="Permalink to this headline">¶</a></h2>
<p>1D transforms can be done with or without data exchange and/or memory reordering. In general, combining a transform with an exchange/reordering can be beneficial for performance due to cache reuse, compared to two separate calls to a transform and an exchange.</p>
<p>The following predefined 1D transforms are available:</p>
<table border="1" class="colwidths-auto docutils">
<tbody valign="top">
<tr class="row-odd"><td>P3DFFT_EMPTY_TYPE</td>
<td>Empty transform</td>
</tr>
<tr class="row-even"><td>P3DFFT_R2CFFT_S, P3DFFT_R2CFFT_D</td>
<td>Real-to-complex forward FFT (as defined in FFTW manual), in single and double precision respectively</td>
</tr>
<tr class="row-odd"><td>P3DFFT_C2RFFT_S, P3DFFT_C2RFFT_D</td>
<td>Complex-to-real backward FFT (as defined in FFTW manual), in single and double precision respectively</td>
</tr>
<tr class="row-even"><td>P3DFFT_CFFT_FORWARD_S, P3DFFT_CFFT_FORWARD_D</td>
<td>Complex forward FFT (as defined in FFTW manual), in single and double precision respectively</td>
</tr>
<tr class="row-odd"><td>P3DFFT_CFFT_BACKWARD_S, P3DFFT_CFFT_BACKWARD_D</td>
<td>Complex backward FFT (as defined in FFTW manual), in single and double precision respectively</td>
</tr>
<tr class="row-even"><td>P3DFFT_DCT&lt;x&gt;_REAL_S, P3DFFT_DCT1_REAL_D</td>
<td>Cosine transform for real-numbered data, in single and double precision, where &lt;x&gt; stands for the variant of the cosine transform, such as DCT1, DCT2, DCT3 or DCT4</td>
</tr>
<tr class="row-odd"><td>P3DFFT_DST&lt;x&gt;_REAL_S, P3DFFT_DST1_REAL_D</td>
<td>Sine transform for real-numbered data, in single and double precision, where &lt;x&gt; stands for the variant of the cosine transform, such as DST1, DST2, DST3 or DST4</td>
</tr>
<tr class="row-even"><td>P3DFFT_DCT&lt;x&gt;_COMPLEX_S, P3DFFT_DCT1_COMPLEX_D</td>
<td>Cosine transform for complex-numbered data, in single and double precision, where &lt;x&gt; stands for the variant of the cosine transform, such as DCT1, DCT2, DCT3 or DCT4</td>
</tr>
<tr class="row-odd"><td>P3DFFT_DST&lt;x&gt;_COMPLEX_S, P3DFFT_DST1_COMPLEX_D</td>
<td>Sine transform for complex-numbered data, in single and double precision, where &lt;x&gt; stands for the variant of the cosine transform, such as DST1, DST2, DST3 or DST4</td>
</tr>
</tbody>
</table>
<div class="section" id="d-transform-planning">
<h3><a class="toc-backref" href="#id10">1D transform planning</a><a class="headerlink" href="#d-transform-planning" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">p3dfft_plan_1Dtrans</span><span class="p">(</span><span class="n">Grid</span> <span class="o">*</span><span class="n">gridIn</span><span class="p">,</span> <span class="n">Grid</span> <span class="o">*</span><span class="n">gridOut</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type1D</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dim</span><span class="p">,</span> <span class="kt">int</span> <span class="n">inplace</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Function</em>: defines and plans a 1D transform of a 3D array. This planning stage must precede execution of 3D transform.</p>
<p><em>Arguments</em>:</p>
<table border="1" class="colwidths-auto docutils">
<tbody valign="top">
<tr class="row-odd"><td>gridIn and gridOut</td>
<td>Pointers to the C equivalent of P3DFFT++ grid object (initial and final)</td>
</tr>
<tr class="row-even"><td>dim</td>
<td>The logical dimension of the transform (0, 1 or 2). Note that this is the logical dimension rank (0 for X, 1 for Y, 2 for Z), and may not be the same as the storage dimension, which depends on mem_order member of gridIn and gridOut. The transform dimension of the grid is assumed to be MPI task-local.</td>
</tr>
<tr class="row-odd"><td>inplace</td>
<td>Indicates that this is not an in-place transform (a non-zero argument would indicate in-place).</td>
</tr>
</tbody>
</table>
<p><em>Return value</em>: The function returns a handle for the transform that can be used in other function calls.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This initialization/planning needs to be done once per transform type.</p>
</div>
</div>
<div class="section" id="d-transform-execution">
<h3><a class="toc-backref" href="#id11">1D transform execution</a><a class="headerlink" href="#d-transform-execution" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">p3dfft_exec_1Dtrans_double</span><span class="p">(</span><span class="kt">int</span> <span class="n">mytrans</span><span class="p">,</span> <span class="kt">double</span> <span class="o">*</span><span class="n">IN</span><span class="p">,</span> <span class="kt">double</span> <span class="o">*</span><span class="n">OUT</span><span class="p">)</span>

<span class="kt">void</span> <span class="n">p3dfft_exec_1Dtrans_single</span><span class="p">(</span><span class="kt">int</span> <span class="n">mytrans</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">IN</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">OUT</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Function</em>: executes double or single precision 1D transform, respectively, of a 3D array</p>
<p><em>Arguments</em>:</p>
<table border="1" class="colwidths-auto docutils">
<tbody valign="top">
<tr class="row-odd"><td>mytrans</td>
<td>The handle for the 1Dtransform</td>
</tr>
<tr class="row-even"><td>IN and OUT</td>
<td>Pointers to one-dimensional input and output arrays containing the 3D grid stored contiguously in memory based on the local grid dimensions and storage order of gridIn and gridOut.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>The execution can be performed many times with the same handle and same or different input and output arrays.</li>
<li>In case of out-of-place transform the input and output arrays must be non-overlapping.</li>
<li>Both input and output arrays must be local in the dimension of transform</li>
</ol>
</div>
</div>
</div>
<div class="section" id="three-dimensional-transforms">
<h2><a class="toc-backref" href="#id12">Three-dimensional Transforms</a><a class="headerlink" href="#three-dimensional-transforms" title="Permalink to this headline">¶</a></h2>
<div class="section" id="p3dfft-init-3dtype">
<h3><a class="toc-backref" href="#id13">p3dfft_init_3Dtype</a><a class="headerlink" href="#p3dfft-init-3dtype" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">p3dfft_init_3Dtype</span><span class="p">(</span><span class="kt">int</span> <span class="n">type_ids</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p><em>Function</em>: Defines a 3D transform type</p>
<p><em>Arguments</em>:</p>
<table border="1" class="colwidths-auto docutils">
<tbody valign="top">
<tr class="row-odd"><td>type_ids</td>
<td>An array of three 1D transform types.</td>
</tr>
</tbody>
</table>
<p><em>Return value</em>: a handle for 3D transform type.</p>
<p>Example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">type_rcc</span><span class="p">,</span> <span class="n">type_ids</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>

<span class="n">type_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">P3DFFT_R2CFFT_D</span><span class="p">;</span>
<span class="n">type_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">P3DFFT_CFFT_FORWARD_D</span><span class="p">;</span>
<span class="n">type_ids</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">P3DFFT_CFFT_FORWARD_D</span><span class="p">;</span>

<span class="n">type_rcc</span> <span class="o">=</span> <span class="n">p3dfft_init_3Dtype</span><span class="p">(</span><span class="n">type_ids</span><span class="p">);</span>
</pre></div>
</div>
<p>In this example type_rcc will describe the real-to-complex (R2C) 3D transform (R2C in 1D followed by two complex 1D transforms).</p>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id14">3D transform planning</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">p3dfft_plan_3Dtrans</span><span class="p">(</span><span class="n">Grid</span> <span class="o">*</span><span class="n">gridIn</span><span class="p">,</span> <span class="n">Grid</span> <span class="o">*</span><span class="n">gridOut</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type3D</span><span class="p">,</span> <span class="kt">int</span> <span class="n">inplace</span><span class="p">,</span> <span class="kt">int</span> <span class="n">overwrite</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Function</em>: plans a 3D transform. This planning stage must precede execution of 3D transform.</p>
<p><em>Arguments</em>:</p>
<table border="1" class="colwidths-auto docutils">
<tbody valign="top">
<tr class="row-odd"><td>gridIn and gridOut</td>
<td>Pointers to initial and final grid objects</td>
</tr>
<tr class="row-even"><td>type3D</td>
<td>The 3D transform type defined as above</td>
</tr>
<tr class="row-odd"><td>inplace</td>
<td>An integer indicating an in-place transform if it's non-zero, out-of-place otherwise.</td>
</tr>
<tr class="row-even"><td>overwrite (optional)</td>
<td>Non-zero when it is OK to overwrite the input array (optional argument, default is 0)</td>
</tr>
</tbody>
</table>
<p><em>Return value</em>: The function returns an integer handle to the 3D transform that can be called multiple times by an execute function.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>This initialization/planning needs to be done once per transform type.</li>
<li>The final grid may or may not be the same as the initial grid. First, in real-to-complex and complex-to-real transforms the global grid dimensions change for example from (n0,n1,n2) to (n0/2+1,n1,n2), since most applications attempt to save memory by using the conjugate symmetry of the Fourier transform of real data. Secondly, the final grid may have different processor distribution and memory ordering, since for example many applications with convolution and those solving partial differential equations do not need the initial grid configuration in Fourier space. The flow of these applications is typically 1) transform from physical to Fourier space, 2) apply convolution or derivative calculation in Fourier space, and 3) inverse FFT to physical space. Since forward FFT's last step is 1D FFT in the third dimension, it is more efficient to leave this dimension local and stride-1, and since the first step of the inverse FFT is to start with the third dimension 1D FFT, this format naturally fits the algorithm and results in big savings of time due to elimination of several extra transposes.</li>
</ol>
</div>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id15">3D Transform Execution</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">p3dfft_exec_3Dtrans_single</span><span class="p">(</span><span class="kt">int</span> <span class="n">mytrans</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">In</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">Out</span><span class="p">)</span>

<span class="kt">void</span> <span class="n">p3dfft_exec_3Dtrans_double</span><span class="p">(</span><span class="kt">int</span> <span class="n">mytrans</span><span class="p">,</span> <span class="kt">double</span> <span class="o">*</span><span class="n">In</span><span class="p">,</span> <span class="kt">double</span> <span class="o">*</span><span class="n">Out</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Function</em>: execute 3D transform in single or double precision, respectively</p>
<p><em>Arguments</em>:</p>
<table border="1" class="colwidths-auto docutils">
<tbody valign="top">
<tr class="row-odd"><td>In and Out</td>
<td>Pointers to input and output arrays, assumed to be the local portion of the 3D grid array,  stored contiguously in memory, consistent with definition of Grid in planning stage.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>Unless inplace was defined in the planning stage of mytrans, In and Out must be non-overlapping</li>
<li>These functions can be used multiple times after the 3D transform has been defined and planned.</li>
</ol>
</div>
</div>
<div class="section" id="d-spectral-derivative">
<h3><a class="toc-backref" href="#id16">3D Spectral Derivative</a><a class="headerlink" href="#d-spectral-derivative" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">p3dfft_exec_3Dtrans_single</span><span class="p">(</span><span class="kt">int</span> <span class="n">mytrans</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">In</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">Out</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idir</span><span class="p">)</span>

<span class="kt">void</span> <span class="n">p3dfft_exec_3Dtrans_double</span><span class="p">(</span><span class="kt">int</span> <span class="n">mytrans</span><span class="p">,</span> <span class="kt">double</span> <span class="o">*</span><span class="n">In</span><span class="p">,</span> <span class="kt">double</span> <span class="o">*</span><span class="n">Out</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idir</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Function</em>: execute 3D real-to-complex FFT, followed by spectral derivative calculation, i.e. multiplication by (ik), where i is the complex imaginary unit, and k is the wavenumber; in single or double precision, respectively</p>
<p><em>Arguments</em></p>
<table border="1" class="colwidths-auto docutils">
<tbody valign="top">
<tr class="row-odd"><td>In and Out</td>
<td>Pointers to input and output arrays, assumed to be the local portion of the 3D grid array stored contiguously in memory, consistent with definition of Grid in planning stage.</td>
</tr>
<tr class="row-even"><td>idir</td>
<td>The dimension where derivative is to be taken in (this is logical dimension, NOT storage mapped). Valid values are 0 - 2.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>Unless inplace was defined in the planning stage of mytrans, In and Out must be non-overlapping</li>
<li>These functions can be used multiple times after the 3D transform has been defined and planned.</li>
</ol>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="p3dfft++_fortran_reference.html" class="btn btn-neutral float-right" title="P3DFFT++ Fortran Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="p3dfft++_c++_reference.html" class="btn btn-neutral float-left" title="P3DFFT++ C++ Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Dmitry Pekurovsky

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>