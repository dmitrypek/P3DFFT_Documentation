

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>P3DFFT++ Fortran Reference &mdash; P3DFFT++ 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="P3DFFT++ C++ examples" href="p3dfft++_c++_examples.html" />
    <link rel="prev" title="P3DFFT++ C Reference" href="p3dfft++_c_reference.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #db4c3f" >
          

          
            <a href="index.html" class="icon icon-home"> P3DFFT++
          

          
          </a>

          
            
            
              <div class="version">
                3.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="home.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_p3dfft.html">Install P3DFFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="download_p3dfft.html">Download P3DFFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="p3dfft_documentation.html">P3DFFT Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_p3dfft++.html">Install P3DFFT++</a></li>
<li class="toctree-l1"><a class="reference internal" href="download_p3dfft++.html">Download P3DFFT++</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="p3dfft++_documentation.html">P3DFFT++ Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_tutorial.html">P3DFFT++ Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_c++_reference.html">P3DFFT++ C++ reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_c_reference.html">P3DFFT++ C Reference</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">P3DFFT++ Fortran Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup-and-grid-layout">Setup and Grid Layout</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#p3dfft-setup">p3dfft_setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#p3dfft-cleanup">p3dfft_cleanup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#p3dfft-init-grid">p3dfft_init_grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="#p3dfft-free-grid-f">p3dfft_free_grid_f</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#one-dimensional-1d-transforms">One-dimensional (1D) Transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#d-transform-planning">1D transform planning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#d-transform-execution">1D transform execution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#three-dimensional-transforms">Three-dimensional transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">3D transform planning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">3D transform execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#d-spectral-derivative">3D Spectral Derivative</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_c++_examples.html">P3DFFT++ C++ examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_c_examples.html">P3DFFT++ C examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3dfft++_fortran_examples.html">P3DFFT++ Fortran examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="license_of_use.html">License of use</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">P3DFFT++</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="p3dfft++_documentation.html">P3DFFT++ Documentation</a> &raquo;</li>
        
      <li>P3DFFT++ Fortran Reference</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/p3dfft++_fortran_reference.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="p3dfft-fortran-reference">
<h1><a class="toc-backref" href="#id8">P3DFFT++ Fortran Reference</a><a class="headerlink" href="#p3dfft-fortran-reference" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#p3dfft-fortran-reference" id="id8">P3DFFT++ Fortran Reference</a><ul>
<li><a class="reference internal" href="#setup-and-grid-layout" id="id9">Setup and Grid Layout</a><ul>
<li><a class="reference internal" href="#p3dfft-setup" id="id10">p3dfft_setup</a></li>
<li><a class="reference internal" href="#p3dfft-cleanup" id="id11">p3dfft_cleanup</a></li>
<li><a class="reference internal" href="#p3dfft-init-grid" id="id12">p3dfft_init_grid</a></li>
<li><a class="reference internal" href="#p3dfft-free-grid-f" id="id13">p3dfft_free_grid_f</a></li>
</ul>
</li>
<li><a class="reference internal" href="#one-dimensional-1d-transforms" id="id14">One-dimensional (1D) Transforms</a><ul>
<li><a class="reference internal" href="#d-transform-planning" id="id15">1D transform planning</a></li>
<li><a class="reference internal" href="#d-transform-execution" id="id16">1D transform execution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#three-dimensional-transforms" id="id17">Three-dimensional transforms</a><ul>
<li><a class="reference internal" href="#id1" id="id18">3D transform planning</a></li>
<li><a class="reference internal" href="#id2" id="id19">3D transform execution</a></li>
<li><a class="reference internal" href="#d-spectral-derivative" id="id20">3D Spectral Derivative</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="setup-and-grid-layout">
<h2><a class="toc-backref" href="#id9">Setup and Grid Layout</a><a class="headerlink" href="#setup-and-grid-layout" title="Permalink to this headline">¶</a></h2>
<p>In Fortran the grid structure is hidden and is operated on by integer handles.</p>
<div class="section" id="p3dfft-setup">
<h3><a class="toc-backref" href="#id10">p3dfft_setup</a><a class="headerlink" href="#p3dfft-setup" title="Permalink to this headline">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">p3dfft_setup</span>
</pre></div>
</div>
<p><strong>Function</strong>: Called once in the beginning of use to initialize P3DFFT++.</p>
</div>
<div class="section" id="p3dfft-cleanup">
<h3><a class="toc-backref" href="#id11">p3dfft_cleanup</a><a class="headerlink" href="#p3dfft-cleanup" title="Permalink to this headline">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">p3dfft_cleanup</span>
</pre></div>
</div>
<p><strong>Function</strong>: Called once before exit and after the use to free up P3DFFT++ structures.</p>
</div>
<div class="section" id="p3dfft-init-grid">
<h3><a class="toc-backref" href="#id12">p3dfft_init_grid</a><a class="headerlink" href="#p3dfft-init-grid" title="Permalink to this headline">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">function </span><span class="n">p3dfft_init_grid</span><span class="p">(</span><span class="n">ldims</span><span class="p">,</span> <span class="n">glob_start</span><span class="p">,</span> <span class="n">gdims</span><span class="p">,</span> <span class="n">dim_conj_sym</span><span class="p">,</span> <span class="n">pgrid</span><span class="p">,</span> <span class="n">proc_order</span><span class="p">,</span> <span class="n">mem_order</span><span class="p">,</span> <span class="n">mpicomm</span><span class="p">)</span>

<span class="kt">integer</span><span class="p">(</span><span class="kt">C_INT</span><span class="p">)</span> <span class="n">p3dfft_init_grid</span>
</pre></div>
</div>
<p><strong>Function</strong>: Initializes a new grid</p>
<table border="1" class="colwidths-auto docutils" id="id3">
<caption><span class="caption-text"><strong>IN</strong></span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>integer gdims(3)</em></td>
<td>Three global grid dimensions (logical order - X, Y, Z).</td>
</tr>
<tr class="row-odd"><td><em>integer dim_conj_sym</em></td>
<td>Dimension of the array in which a little less than half of the elements are omitted due to conjugate symmetry. This argument should be non-negative only for complex-valued arrays resulting from real-to-complex FFT in the given dimension.</td>
</tr>
<tr class="row-even"><td><em>integer pgrid(3)</em></td>
<td>Up to three dimensions of processor grid, decomposing the global grid array. Value = 1 means the grid is not decomposed but is local in that logical dimension.</td>
</tr>
<tr class="row-odd"><td><em>integer proc_order(3)</em></td>
<td>A permutation of the 3 integers: <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">2</span></code>. Specifies the topology of processor grid on the interconnect. The dimension with lower value means the MPI tasks in that dimension are closer in ranks, e.g. value=0 means the ranks are adjacent (stride=1), value=1 means they are speard out with the stride equal to the pgrid value of the dimension with stride=1 etc.</td>
</tr>
<tr class="row-even"><td><em>integer mem_order(3)</em></td>
<td>A permutation of the 3 integers: 0, 1 and 2. Specifies mapping of the logical dimension and memory storage dimensions for local memory for each MPI task. <code class="docutils literal notranslate"><span class="pre">mem_order(i0)</span> <span class="pre">=</span> <span class="pre">0</span></code> means that the i0's logical dimension is stored with <code class="docutils literal notranslate"><span class="pre">stride=1</span></code> in memory. Similarly, <code class="docutils literal notranslate"><span class="pre">mem_order(i1)</span> <span class="pre">=</span> <span class="pre">1</span></code> means that i1's logical dimension is stored with <code class="docutils literal notranslate"><span class="pre">stride=ldims(i0)</span></code> etc.</td>
</tr>
<tr class="row-odd"><td><em>integer mpicomm</em></td>
<td>The MPI communicator in which this grid lives.</td>
</tr>
</tbody>
</table>
<table border="1" class="colwidths-auto docutils" id="id4">
<caption><span class="caption-text"><strong>OUT</strong></span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>integer ldims(3)</em></td>
<td>Local dimensions of the grid for each MPI tasks, in order of logical dimensions numbering (XYZ). Essentially ldims = <em>gdims</em> / <em>pgrid</em>.</td>
</tr>
<tr class="row-odd"><td><em>integer glob_start(3)</em></td>
<td>Starting coordinates of the local portion of the grid within the global grid.</td>
</tr>
</tbody>
</table>
<p><strong>Return value</strong>: An integer handle of the initialized grid, to be used later by various routines accessing the grid.</p>
</div>
<div class="section" id="p3dfft-free-grid-f">
<h3><a class="toc-backref" href="#id13">p3dfft_free_grid_f</a><a class="headerlink" href="#p3dfft-free-grid-f" title="Permalink to this headline">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">p3dfft_free_grid_f</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Function</strong>: Frees the grid handle.</p>
<table border="1" class="colwidths-auto docutils" id="id5">
<caption><span class="caption-text"><strong>IN</strong></span><a class="headerlink" href="#id5" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>integer(C_INT) grid</em></td>
<td>The handle of the grid to be freed.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="one-dimensional-1d-transforms">
<h2><a class="toc-backref" href="#id14">One-dimensional (1D) Transforms</a><a class="headerlink" href="#one-dimensional-1d-transforms" title="Permalink to this headline">¶</a></h2>
<p>The following predefined 1D transforms are available:</p>
<table border="1" class="colwidths-auto docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">Transform</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">P3DFFT_EMPTY_TYPE</span></code></td>
<td>Empty transform.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">P3DFFT_R2CFFT_S</span></code>, <code class="docutils literal notranslate"><span class="pre">P3DFFT_R2CFFT_D</span></code></td>
<td>Real-to-complex forward FFT (as defined in FFTW manual), in single and double precision respectively.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">3DFFT_C2RFFT_S</span></code>, <code class="docutils literal notranslate"><span class="pre">3DFFT_C2RFFT_D</span></code></td>
<td>Complex-to-real backward FFT (as defined in FFTW manual), in single and double precision respectively.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">3DFFT_CFFT_FORWARD_S</span></code>, <code class="docutils literal notranslate"><span class="pre">3DFFT_CFFT_FORWARD_D</span></code></td>
<td>Complex forward FFT (as defined in FFTW manual), in single and double precision respectively.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">3DFFT_CFFT_BACKWARD_S</span></code>, <code class="docutils literal notranslate"><span class="pre">3DFFT_CFFT_BACKWARD_D</span></code></td>
<td>Complex backward FFT (as defined in FFTW manual), in single and double precision respectively.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">3DFFT_DCT&lt;x&gt;_REAL_S</span></code>, <code class="docutils literal notranslate"><span class="pre">3DFFT_DCT1_REAL_D</span></code></td>
<td>Cosine transform for real-numbered data, in single and double precision, where <em>&lt;x&gt;</em> stands for the variant of the cosine transform, such as <code class="docutils literal notranslate"><span class="pre">DCT1</span></code>, <code class="docutils literal notranslate"><span class="pre">DCT2</span></code>, <code class="docutils literal notranslate"><span class="pre">DCT3</span></code>, or <code class="docutils literal notranslate"><span class="pre">DCT4</span></code>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">P3DFFT_DST&lt;x&gt;_REAL_S</span></code>, <code class="docutils literal notranslate"><span class="pre">P3DFFT_DST1_REAL_D</span></code></td>
<td>Sine transform for real-numbered data, in single and double precision, where <em>&lt;x&gt;</em> stands for the variant of the cosine transform, such as <code class="docutils literal notranslate"><span class="pre">DST1</span></code>, <code class="docutils literal notranslate"><span class="pre">DST2</span></code>, <code class="docutils literal notranslate"><span class="pre">DST3</span></code>, or <code class="docutils literal notranslate"><span class="pre">DST4</span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">P3DFFT_DCT&lt;x&gt;_COMPLEX_S</span></code>, <code class="docutils literal notranslate"><span class="pre">P3DFFT_DCT1_COMPLEX_D</span></code></td>
<td>Cosine transform for complex-numbered data, in single and double precision, where <em>&lt;x&gt;</em> stands for the variant of the cosine transform, such as <code class="docutils literal notranslate"><span class="pre">DCT1</span></code>, <code class="docutils literal notranslate"><span class="pre">DCT2</span></code>, <code class="docutils literal notranslate"><span class="pre">DCT3</span></code>, or <code class="docutils literal notranslate"><span class="pre">DCT4</span></code>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">P3DFFT_DST&lt;x&gt;_COMPLEX_S</span></code>, <code class="docutils literal notranslate"><span class="pre">P3DFFT_DST1_COMPLEX_D</span></code></td>
<td>Sine transform for complex-numbered data, in single and double precision, where <em>&lt;x&gt;</em> stands for the variant of the cosine transform, such as <code class="docutils literal notranslate"><span class="pre">DST1</span></code>, <code class="docutils literal notranslate"><span class="pre">DST2</span></code>, <code class="docutils literal notranslate"><span class="pre">DST3</span></code>, or <code class="docutils literal notranslate"><span class="pre">DST4</span></code>.</td>
</tr>
</tbody>
</table>
<div class="section" id="d-transform-planning">
<h3><a class="toc-backref" href="#id15">1D transform planning</a><a class="headerlink" href="#d-transform-planning" title="Permalink to this headline">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">function </span><span class="n">p3dfft_plan_1Dtrans_f</span><span class="p">(</span><span class="n">gridIn</span><span class="p">,</span> <span class="n">gridOut</span><span class="p">,</span> <span class="k">type</span><span class="p">,</span> <span class="nb">dim</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>

<span class="kt">integer </span><span class="n">p3dfft_plan_1Dtrans</span>
</pre></div>
</div>
<p><strong>Function</strong>: Defines and plans a 1D transform of a 3D array in a given dimension.</p>
<table border="1" class="colwidths-auto docutils" id="id6">
<caption><span class="caption-text"><strong>IN</strong></span><a class="headerlink" href="#id6" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>integer gridIn</em></td>
<td>Initial grid handle.</td>
</tr>
<tr class="row-odd"><td><em>integer gridOut</em></td>
<td>Destination grid handle.</td>
</tr>
<tr class="row-even"><td><em>integer type</em></td>
<td>1D transform type.</td>
</tr>
<tr class="row-odd"><td><em>integer dim</em></td>
<td>Dimension rank of the 3D array which should be transformed. valid values are <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, or <code class="docutils literal notranslate"><span class="pre">2</span></code>. Note that this is the logical dimension rank (<code class="docutils literal notranslate"><span class="pre">0</span></code> for X, <code class="docutils literal notranslate"><span class="pre">1</span></code> for Y, <code class="docutils literal notranslate"><span class="pre">2</span></code> for Z), and may not be the same as the storage dimension, which depends on <code class="docutils literal notranslate"><span class="pre">mem_order</span></code> member of <strong>gridIn</strong> and <strong>gridOut</strong>. The transform dimension of the grid is assumed to be MPI task-local.</td>
</tr>
<tr class="row-even"><td><em>integer inplace</em></td>
<td>Nonzero value if the transform is in-place.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="d-transform-execution">
<h3><a class="toc-backref" href="#id16">1D transform execution</a><a class="headerlink" href="#d-transform-execution" title="Permalink to this headline">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">p3dfft_exec_1Dtrans_single</span><span class="p">(</span><span class="n">mytrans</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">out</span><span class="p">)</span>

<span class="k">subroutine </span><span class="n">p3dfft_exec_1Dtrans_double</span><span class="p">(</span><span class="n">mytrans</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Function</strong>: Executes a 1D transform of a 3D array, in single or double precision.</p>
<table border="1" class="colwidths-auto docutils" id="id7">
<caption><span class="caption-text"><strong>IN</strong></span><a class="headerlink" href="#id7" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>mytrans</em></td>
<td>The handle of a 1D transform predefined earlier with <code class="docutils literal notranslate"><span class="pre">p3dfft_plan_1Dtrans</span></code>.</td>
</tr>
<tr class="row-odd"><td><em>in</em></td>
<td>3D array to be transformed</td>
</tr>
<tr class="row-even"><td><em>out</em></td>
<td>Destination array (can be the same if inplace was nonzero when defining <code class="docutils literal notranslate"><span class="pre">mytrans</span></code>)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>If <code class="docutils literal notranslate"><span class="pre">inplace</span></code> was not defined the input and output arrays must be non-overlapping.</li>
<li>This transform is done in the dimension specified in <code class="docutils literal notranslate"><span class="pre">p3dfft_plan_1Dtrans</span></code>, and this dimension should be local for both input and output arrays.</li>
<li>This subroutine can be called multiple times with the same mytrans and same or different <em>in</em>/<em>out</em>.</li>
</ol>
</div>
</div>
</div>
<div class="section" id="three-dimensional-transforms">
<h2><a class="toc-backref" href="#id17">Three-dimensional transforms</a><a class="headerlink" href="#three-dimensional-transforms" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id18">3D transform planning</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">function </span><span class="n">p3dfft_plan_3Dtrans_f</span><span class="p">(</span><span class="n">gridIn</span><span class="p">,</span><span class="n">gridOut</span><span class="p">,</span><span class="k">type</span><span class="p">,</span><span class="n">inplace</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">)</span>

<span class="kt">integer </span><span class="n">p3dfft_plan_3Dtrans_f</span>
</pre></div>
</div>
<p><strong>Function</strong>: Defines and plans a 3D transform.</p>
<table border="1" class="colwidths-auto docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>integer gridIn</em></td>
<td>Initial grid handle</td>
</tr>
<tr class="row-odd"><td><em>integer gridOut</em></td>
<td>Destination grid handle</td>
</tr>
<tr class="row-even"><td><em>integer type(3)</em></td>
<td>Three 1D transform types making up the desired 3D transform</td>
</tr>
<tr class="row-odd"><td><em>integer inplace</em></td>
<td>If nonzero, the transform takes place in-place</td>
</tr>
<tr class="row-even"><td><em>integer overwrite</em></td>
<td>Nonzero if the input can be overwritten</td>
</tr>
</tbody>
</table>
<p><strong>Return value</strong>: A handle of the 3D transform</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The final grid may or may not be the same as the initial grid. First, in real-to-complex and complex-to-real transforms the global grid dimensions change for example from (n0,n1,n2) to (n0/2+1,n1,n2), since most applications attempt to save memory by using the conjugate symmetry of the Fourier transform of real data. Secondly, the final grid may have different processor distribution and memory ordering, since for example many applications with convolution and those solving partial differential equations do not need the initial grid configuration in Fourier space. The flow of these applications is typically 1) transform from physical to Fourier space, 2) apply convolution or derivative calculation in Fourier space, and 3) inverse FFT to physical space. Since forward FFT's last step is 1D FFT in the third dimension, it is more efficient to leave this dimension local and stride-1, and since the first step of the inverse FFT is to start with the third dimension 1D FFT, this format naturally fits the algorithm and results in big savings of time due to elimination of several extra transposes.</p>
</div>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id19">3D transform execution</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">p3dfft_exec_3Dtrans_single</span><span class="p">(</span><span class="n">mytrans</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">out</span><span class="p">)</span>

<span class="k">subroutine </span><span class="n">p3dfft_exec_3Dtrans_double</span><span class="p">(</span><span class="n">mytrans</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Function</strong>: Executes a predefined 3D transform in single or double precision.</p>
<table border="1" class="colwidths-auto docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>mytrans</em></td>
<td>The handle of the predefined 3D transform</td>
</tr>
<tr class="row-odd"><td><em>in</em></td>
<td>Input array</td>
</tr>
<tr class="row-even"><td><em>out</em></td>
<td>Output array</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This subroutine can be called multiple times for the same <code class="docutils literal notranslate"><span class="pre">mytrans</span></code> and same or different <em>in</em>/<em>out</em>.Input and output arrays are local portions of the global 3D array, assumed to be stored contiguously in memory following the definition of the grids in planning stage.</p>
</div>
</div>
<div class="section" id="d-spectral-derivative">
<h3><a class="toc-backref" href="#id20">3D Spectral Derivative</a><a class="headerlink" href="#d-spectral-derivative" title="Permalink to this headline">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">p3dfft_exec_3Dtrans_single</span><span class="p">(</span><span class="n">mytrans</span><span class="p">,</span> <span class="n">In</span><span class="p">,</span> <span class="n">Out</span><span class="p">,</span> <span class="n">idir</span><span class="p">)</span>

<span class="n">p3dfft_exec_3Dtrans_double</span><span class="p">(</span><span class="n">mytrans</span><span class="p">,</span> <span class="n">In</span><span class="p">,</span> <span class="n">Out</span><span class="p">,</span> <span class="n">idir</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Function</strong>: Execute 3D real-to-complex FFT, followed by spectral derivative calculation, i.e. multiplication by (ik), where i is the complex imaginary unit, and k is the wavenumber; in single or double precision, respectively.</p>
<table border="1" class="colwidths-auto docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>In</em>, <em>Out</em></td>
<td>Input and output arrays, assumed to be the local portion of the 3D grid array stored contiguously in memory, consistent with definition of <code class="docutils literal notranslate"><span class="pre">Grid</span></code> in planning stage.</td>
</tr>
<tr class="row-odd"><td><em>integer idir</em></td>
<td>The dimension where derivative is to be taken in (this is logical dimension, NOT storage mapped). Valid values are <code class="docutils literal notranslate"><span class="pre">0</span></code> - <code class="docutils literal notranslate"><span class="pre">2</span></code>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>Unless <code class="docutils literal notranslate"><span class="pre">inplace</span></code> was defined in the planning stage of <code class="docutils literal notranslate"><span class="pre">mytrans</span></code>, <strong>In</strong> and <strong>Out</strong> must be non-overlapping.</li>
<li>These functions can be used multiple times after the 3D transform has been defined and planned.</li>
</ol>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="p3dfft++_c++_examples.html" class="btn btn-neutral float-right" title="P3DFFT++ C++ examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="p3dfft++_c_reference.html" class="btn btn-neutral float-left" title="P3DFFT++ C Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Dmitry Pekurovsky

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>